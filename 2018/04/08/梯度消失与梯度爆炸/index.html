<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">






    <link rel="dns-prefetch" href="https://cdn-city.livere.com"/>






    <link rel="dns-prefetch" href="https://fonts.proxy.ustclug.org"/>





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            梯度消失与梯度爆炸 | 
        
        Hey~YaHei!
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content=",《Handson-ML》笔记">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?NKhlKQkXw/c66TR5p4wO+w==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.proxy.ustclug.org/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","https://cdn.bootcss.com/jquery/2.2.0/jquery.min.js", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Hey~YaHei!">
    <meta name="msapplication-starturl" content="http://hey-yahei.cn/2018/04/08/梯度消失与梯度爆炸/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Hey~YaHei!">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    <meta name="google-site-verification" content="9RYmZ6xORQYm4BISDRGPi57Oj0NzoKAN-U9ZR6UxSxY" />
    <meta name="baidu-site-verification" content="xij8ev3DGx" />

    <!-- RSS -->
    
        
            <link rel=alternate type="application/rss+xml" href="/rss2.xml">
        
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://hey-yahei.cn/2018/04/08/梯度消失与梯度爆炸/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="梯度消失与梯度爆炸 | Hey~YaHei!">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="《Handson-ML》笔记"> 

    
        <meta property="article:published_time" content="Sun Apr 08 2018 00:00:00 GMT+0800">
        <meta property="article:modified_time" content="Tue Sep 18 2018 20:47:29 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://hey-yahei.cn/2018/04/08/梯度消失与梯度爆炸/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://hey-yahei.cn/2018/04/08/梯度消失与梯度爆炸/index.html",
    "headline": "梯度消失与梯度爆炸",
    "datePublished": "Sun Apr 08 2018 00:00:00 GMT+0800",
    "dateModified": "Tue Sep 18 2018 20:47:29 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "YaHei",
        "image": {
            "@type": "ImageObject",
            "url": "/imgs/avatar2.jpg"
        },
        "description": "Hey!"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Hey~YaHei!",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",《Handson-ML》笔记",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解决梯度爆炸和消失的常用技术"><span class="post-toc-number">1.</span> <span class="post-toc-text">解决梯度爆炸和消失的常用技术</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Xavier-Initialization-Glorot-Initialization"><span class="post-toc-number">2.</span> <span class="post-toc-text">Xavier Initialization(Glorot Initialization)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#relu——nonsaturating-activation-function"><span class="post-toc-number">3.</span> <span class="post-toc-text">relu——nonsaturating activation function</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#批量归一化（Batch-Normalization-BN）"><span class="post-toc-number">4.</span> <span class="post-toc-text">批量归一化（Batch Normalization, BN）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#区分：归一化、正则化、标准化"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">区分：归一化、正则化、标准化</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#具体操作"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">具体操作</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#效果"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">效果</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#在tensorflow中使用BN"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">在tensorflow中使用BN</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#梯度裁剪（Gradient-Clipping）：简单粗暴"><span class="post-toc-number">5.</span> <span class="post-toc-text">梯度裁剪（Gradient Clipping）：简单粗暴</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                梯度消失与梯度爆炸
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/imgs/avatar2.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>YaHei</strong>
        <span>4月 08, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/《Handson-ML》笔记/">《Handson-ML》笔记</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=梯度消失与梯度爆炸&url=http://hey-yahei.cn/2018/04/08/梯度消失与梯度爆炸/index.html&pic=http://hey-yahei.cn/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Hey~YaHei!&title=梯度消失与梯度爆炸&summary=&pics=http://hey-yahei.cn/img/favicon.png&url=http://hey-yahei.cn/2018/04/08/梯度消失与梯度爆炸/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=668472&auto=0&height=32"></iframe><br>BGM：<strong>《钢之炼金术师FA》OP1</strong><br>这个吉他混音版真是太棒了~       </p>
<hr>
<p>参考：     </p>
<ol>
<li>《<a href="https://book.douban.com/subject/26840215/" target="_blank" rel="noopener">Hands-On Machine Learning with Scikit-Learn and TensorFlow(2017)</a>》Chap11<br> <a href="/2018/04/08/Handson-ML/">《Hands-On Machine Learning with Scikit-Learn and TensorFlow》笔记</a>        </li>
<li><a href="https://pan.baidu.com/s/1GF4yLtVphlwFS9by00Ns1Q" target="_blank" rel="noopener">卷积神经网络——深度学习实践手册(2017.05)</a>      </li>
</ol>
<h3 id="解决梯度爆炸和消失的常用技术"><a href="#解决梯度爆炸和消失的常用技术" class="headerlink" title="解决梯度爆炸和消失的常用技术"></a>解决梯度爆炸和消失的常用技术</h3><ol>
<li>随机初始化（Xavier Initialization、He Initialization等）</li>
<li>使用nonsaturating函数（如relu）</li>
<li>批量归一化（Batch Normalization, BN）</li>
<li>梯度裁剪（Gradient Clipping）   </li>
</ol>
<h3 id="Xavier-Initialization-Glorot-Initialization"><a href="#Xavier-Initialization-Glorot-Initialization" class="headerlink" title="Xavier Initialization(Glorot Initialization)"></a>Xavier Initialization(Glorot Initialization)</h3><p>论文：<a href="http://proceedings.mlr.press/v9/glorot10a/glorot10a.pdf" target="_blank" rel="noopener">Understanding the difficulty of training deep feedforward neural networks(2010)</a><br>作者Xavier建议：<strong>使每一层的输入输出的方差相等，而且正反向传播的梯度也相等</strong>       </p>
<p>并针对sigmoid激活函数（logistic激活函数）提出一种初始化方式：     </p>
<ol>
<li>各权重用均值为0的正态分布随机数进行初始化，并且标准差根据输入、输出的维度确定——<br> $$ \sigma = \sqrt{ \frac{2}{n_{inputs} + n_{outputs} } } $$       </li>
<li>用[-r, r]的均匀分布随机数进行初始化——<br> $$ r = \sqrt{ \frac{6}{n_{inputs} + n_{outputs}} } $$        </li>
</ol>
<p>此外，另外一篇论文<a href="https://arxiv.org/pdf/1502.01852v1.pdf" target="_blank" rel="noopener">Delving Deep into Rectifiers:Surpassing Human-Level Performance on ImageNet Classification(2015)</a><br>作者He提出类似的关于其他激活函数的初始化建议：           </p>
<ul>
<li>tanh<br>  $$ \sigma = 4 \sqrt{ \frac{2}{n_{inputs} + n_{outputs} } } $$<br>  $$ r = 4 \sqrt{ \frac{6}{n_{inputs} + n_{outputs}} } $$        </li>
<li>relu及其变体（He Initialization）<br>  $$ \sigma = \sqrt{2} \sqrt{ \frac{2}{n_{inputs} + n_{outputs} } } $$<br>  $$ r = \sqrt{2} \sqrt{ \frac{6}{n_{inputs} + n_{outputs}} } $$        </li>
</ul>
<p>数据敏感的参数初始化方式：<br>是一种根据自身任务数据集量身定制的参数初始化方式；<br>论文：<a href="https://arxiv.org/pdf/1511.06856.pdf" target="_blank" rel="noopener">Data-dependent Initializations of Convolutional Neural Networks(2016)</a><br>代码：<a href="https://github.com/philkr/magic_init" target="_blank" rel="noopener">philkr/magic_init | github</a>     </p>
<h3 id="relu——nonsaturating-activation-function"><a href="#relu——nonsaturating-activation-function" class="headerlink" title="relu——nonsaturating activation function"></a>relu——nonsaturating activation function</h3><ul>
<li>优势      <ul>
<li>sigmoid和tanh是saturate函数——<a href="https://blog.csdn.net/whu_paprika/article/details/54085670" target="_blank" rel="noopener">【机器学习】saturate的解释 | CSDN</a><br>  sigmoid函数介绍参见<a href="/note_for_MLA/Ch05 logRegres.html">机器学习实战 - 逻辑回归 | Hey~YaHei!</a><br>  sigmoid函数与tanh函数线性相关，具体参见<a href="https://www.zhihu.com/question/50396271?from=profile_question_card" target="_blank" rel="noopener">在神经网络中，激活函数sigmoid和tanh除了阈值取值外有什么不同吗？| 知乎</a><br>  sigmoid、tanh、relu的比较参见<a href="https://blog.csdn.net/zchang81/article/details/70224688" target="_blank" rel="noopener">深度学习——激活函数Sigmoid/Tanh/ReLU | CSDN</a><br>  sigmoid的输出限定在[0, 1]之间；<br>  tanh的输出限定在[-1, 1]之间；<br>  而relu的输出为[0, +∞)，为nonsaturae函数</li>
<li>计算非常简单、快速     </li>
</ul>
</li>
<li>存在问题（dying relus）<br>  当输入的加权和为负数时，relu将出现“死亡”而开始不停地输出0（因为当输入为负数时relu的梯度一直是0），最终导致网络崩溃；        </li>
<li><p>变体（解决die问题）<br>  论文 <a href="https://arxiv.org/pdf/1505.00853.pdf" target="_blank" rel="noopener">Empirical Evaluation of Rectified Activations in Convolution Network(2015)</a> 比较了各种不同变体的表现</p>
<ul>
<li><strong>leaky relu</strong><br>  $$ LeakyReLU_\alpha(z) = max(\alpha z, z) $$<br>  其中 $\alpha$ 使 $z&lt;0$ 时有一个小梯度，使得relu不会彻底“死亡”，在接下来的训练中有可能被“复活”；<br>  通常 $\alpha$ 取0.01      </li>
<li><strong>randomized leaky relu（RReLU）</strong><br>  leaky relu的变体，其中 $\alpha$ 在训练中是一个随机数，最终测试时固定为一个平均值        </li>
<li><strong>parametric leaky relu（PReLU）</strong><br>  leaky relu的变体，其中 $\alpha$ 作为模型的一个参数参与训练<br>  论文指出，PReLU在大型图片数据集上有很好的表现，但在小数据集上很快就过拟合   </li>
<li><p><strong>exponential linear unit（ELU）</strong><br>  论文 <a href="https://arxiv.org/pdf/1511.07289v5.pdf" target="_blank" rel="noopener">FAST AND ACCURATE DEEP NETWORK LEARNING BY EXPONENTIAL LINEAR UNITS (ELUS)(2016)</a> 指出，ELU可以减少训练时间，并且在测试集上有更好的表现<br>  $$\begin{equation}<br>  ELU_\alpha (z) = \left\{<br>  \begin{array}{rcl}<br>  \alpha (e^z - 1) &amp; &amp; ,z &lt; 0\\<br>  z &amp; &amp; ,z&gt;=0<br>  \end{array} \right.<br>  \end{equation}$$    </p>
<ul>
<li>ELU在 $z&lt;0$ 时有负数输出，使得单元的平均输出更接近于0，这有助于缓解梯度消失的问题     </li>
<li>$\alpha$ 通常取1，但也可以采用其他方式来确定它的值      </li>
<li>当 $z&lt;0$ 时有非0梯度，有助于避免dying relu问题     </li>
<li>函数光滑，有助于加速梯度下降（而且当 $\alpha=1$ 时，函数在 $z=0$ 上可导）     </li>
<li>ELU因为多了指数运算，其计算要比relu慢，但是因为能更快收敛，所以在训练有一定的补偿；不过在测试时，还是会比较慢     </li>
</ul>
</li>
</ul>
</li>
<li>选择     <ul>
<li>一般来说：ELU &gt; leaky ReLU（及其变体） &gt; ReLU &gt; tanh &gt; logistic         </li>
<li>优先使用<strong>ELU</strong>，但如果需要考虑预测的开销，那么可以使用<strong>leaky ReLU</strong>及其变体       </li>
<li>如果还要进一步节省时间和计算力，可以使用交叉验证来评估不同的激活函数      </li>
<li>如果网络出现过拟合而不想花时间去调参和测试，可以使用<strong>RReLU</strong>     </li>
<li>如果你拥有非常大的数据集，那也可以直接使用<strong>PReLU</strong>    </li>
</ul>
</li>
<li>使用<br>  tensorflow有预置的elu函数     <pre class=" language-python"><code class="language-python">  hidden1 <span class="token operator">=</span> fully_connected<span class="token punctuation">(</span>X<span class="token punctuation">,</span> n_hidden1<span class="token punctuation">,</span> activation_fn<span class="token operator">=</span>tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>elu<span class="token punctuation">)</span>
</code></pre>
  虽然tensorflow没有预置的leaky relus，但是定义起来很容易     <pre class=" language-python"><code class="language-python">  <span class="token keyword">def</span> <span class="token function">leaky_relu</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> name<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> tf<span class="token punctuation">.</span>maximum<span class="token punctuation">(</span><span class="token number">0.01</span> <span class="token operator">*</span> z<span class="token punctuation">,</span> z<span class="token punctuation">,</span> name<span class="token operator">=</span>name<span class="token punctuation">)</span>
  hidden1 <span class="token operator">=</span> fully_connected<span class="token punctuation">(</span>X<span class="token punctuation">,</span> n_hidden1<span class="token punctuation">,</span> activation_fn<span class="token operator">=</span>leaky_relu<span class="token punctuation">)</span>
</code></pre>
</li>
</ul>
<h3 id="批量归一化（Batch-Normalization-BN）"><a href="#批量归一化（Batch-Normalization-BN）" class="headerlink" title="批量归一化（Batch Normalization, BN）"></a>批量归一化（Batch Normalization, BN）</h3><p>随机初始化可以在训练的开始显著减少梯度爆炸和消失的问题，但它不能保证训练过程中不再出现；<br>论文 <a href="https://arxiv.org/pdf/1502.03167v3.pdf" target="_blank" rel="noopener">Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift(2015)</a> 提出了批量归一化技术来解决这个问题，以及Internal Covariate Shift问题（训练过程中，随着前一层参数的变化，本层的输入分布也随之发生变化）；   </p>
<p>BN有一种<strong>特征归一化</strong>（Feature Normalization, FN）的变体；<br>作用于网络最后一层的特征表示上（FN随后接的是目标函数层），用于提高习得特征的分辨能力；<br>可用于人脸识别、行人重检测、车辆重检测等任务上；<br>论文：<a href="https://arxiv.org/pdf/1703.08388.pdf" target="_blank" rel="noopener">DeepVisage: Making face recognition simple yet with powerful generalization skills(2017)</a>   </p>
<h4 id="区分：归一化、正则化、标准化"><a href="#区分：归一化、正则化、标准化" class="headerlink" title="区分：归一化、正则化、标准化"></a>区分：归一化、正则化、标准化</h4><p>参考文章：<a href="https://zhuanlan.zhihu.com/p/29974820" target="_blank" rel="noopener">机器学习里的黑色艺术：normalization, standardization, regularization</a><br><strong>归一化（Normalization）</strong>：数据预处理，将数据限定在特定范围内，消除量纲对建模的影响；<br><strong>标准化（Standardization）</strong>：数据预处理，使数据符合标准正态分布；<br><strong>正则化（Regularization）</strong>：在损失函数中添加惩罚项，增加建模模糊性，将建模关注点转移到整体趋势上；      </p>
<h4 id="具体操作"><a href="#具体操作" class="headerlink" title="具体操作"></a>具体操作</h4><p>归一化的方式有很多种：      </p>
<ol>
<li>最大最小值归一化 $x’ = \frac{x - min}{max - min}$</li>
<li>对数归一化 $ x’ = \frac{lg(x)}{lg(max)} $</li>
<li>反正切归一化 $ x’= \frac{2arctan(x)}{\pi} $</li>
<li>零平均归一化 $ x’ = \frac{x - mean}{std} $</li>
</ol>
<p>根据论文，该技术在每层的<strong>激活函数之前添加一个BN操作</strong>，使得输入的数据以零点为中心、归一化；并且在每一层中使用两个新的参数来调整输出的范围，使得模型的每一层能够学习到适宜的表示范围和平均值；<br>该算法需要评估每一个输入的mini-batch的平均值和标准差；       </p>
<p>对于某个mini-batch的输入，归一化的具体过程如下：<br>$$ \mathbb{ x^{(i)} } = \frac{ x^{(i)} - \mu_B }{ \sqrt{\sigma^2_B + \epsilon} } $$<br>$$ z^{(i)} = \gamma \mathbb{ x^{(i)} } + \beta $$<br>其中，<br>$\mu_B$ 和 $\sigma_B$ 分别是该mini-batch的平均数和标准差；<br>$\epsilon$ 是一个很小的数（通常取0.001），用于避免 $\sigma = 0$ 导致分母为0的情况；<br>$\gamma$ 和 $\beta$ 分别是每一层中的两个新的参数，调整后的 $\mathbb{x^{(i)}}$ 通过线性变化后得到归一化的 $z^{(i)}$ 输出      </p>
<p>在预测阶段因为不再有mini-batch，所以直接使用在整个训练集的平均数、标准差进行计算即可；<br>所以在训练时每层会增加四个参数：$\gamma, \beta, \mu, \sigma$ ，训练时采用移动平均的方式可以高效地获得在整个训练集各层的平均值和标准差；   </p>
<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><ol>
<li>可以很好的解决梯度爆炸和消失的问题，甚至saturate函数如sigmoid和tanh都可以在深度网络中正常使用； </li>
<li>网络对权重初始化不再那么敏感    </li>
<li>可以使用更大的学习率，提高训练速度      </li>
<li>具有正则化的效果，可以减少dropout等其他正则化技术的使用</li>
<li>缺点：BN操作增加了模型的复杂度，预测时间将不可避免地增加<br> 但是，在训练完成后，BN层可以合并到前一层的卷积层或全连接层，具体参见《<a href="/MobileNets-SSD/#BN层合并">MobileNet-SSD网络解析 - BN层合并 | Hey~YaHei!</a>》        </li>
</ol>
<h4 id="在tensorflow中使用BN"><a href="#在tensorflow中使用BN" class="headerlink" title="在tensorflow中使用BN"></a>在tensorflow中使用BN</h4><p>tensorflow提供了现成的BN层操作： <code>tensorflow.contrib.layers.batch_norm</code><br>可以直接作为参数传递给 <code>fully_connected</code> 全连接网络： </p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>layers <span class="token keyword">import</span> batch_norm

<span class="token comment" spellcheck="true"># ...</span>

<span class="token comment" spellcheck="true"># 训练标志</span>
<span class="token comment" spellcheck="true"># ... 如前所述，BN在训练和预测时模型略有不同</span>
<span class="token comment" spellcheck="true"># ... 训练时，模型需要每次都对mini-batch计算平均值和标准差，并用滑动平均的方式记录整个训练集上的平均值和标准差</span>
<span class="token comment" spellcheck="true"># ... 预测时则直接使用整个训练集上的平均值和标准差</span>
is_training <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>bool<span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'is_training'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># BN操作的参数，包括——</span>
<span class="token comment" spellcheck="true"># ... is_training：标志训练与否状态的占位符</span>
<span class="token comment" spellcheck="true"># ... decay：使学习率下降的一个因子，v &lt;- v*decay + v*(1-decay)</span>
<span class="token comment" spellcheck="true"># ... updates_collections：</span>
bn_params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'is_training'</span><span class="token punctuation">:</span> is_training<span class="token punctuation">,</span>
    <span class="token string">'decay'</span><span class="token punctuation">:</span> <span class="token number">0.99</span><span class="token punctuation">,</span>
    <span class="token string">'updates_collections'</span><span class="token punctuation">:</span> None
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true"># 指定全连接网络使用BN操作</span>
hidden1 <span class="token operator">=</span> fully_connected<span class="token punctuation">(</span>X<span class="token punctuation">,</span> n_hidden1<span class="token punctuation">,</span> scope <span class="token operator">=</span> <span class="token string">"hidden1"</span><span class="token punctuation">,</span>
                  normalizer_fn <span class="token operator">=</span> batch_norm<span class="token punctuation">,</span> normalizer_params <span class="token operator">=</span> bn_params<span class="token punctuation">)</span>
hidden2 <span class="token operator">=</span> fully_connected<span class="token punctuation">(</span>hidden1<span class="token punctuation">,</span> n_hidden2<span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token string">"hidden2"</span><span class="token punctuation">,</span>
                  normalizer_fn <span class="token operator">=</span> batch_norm<span class="token punctuation">,</span> normalizer_params <span class="token operator">=</span> bn_params<span class="token punctuation">)</span>
logits <span class="token operator">=</span> fully_connected<span class="token punctuation">(</span>hidden2<span class="token punctuation">,</span> n_outputs<span class="token punctuation">,</span> activation_fn<span class="token operator">=</span>None<span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token string">"outputs"</span><span class="token punctuation">,</span>
                  normalizer_fn <span class="token operator">=</span> batch_norm<span class="token punctuation">,</span> normalizer_params <span class="token operator">=</span> bn_params<span class="token punctuation">)</span>
</code></pre>
<p>如果觉得每次都需要指定归一化的函数和参数太麻烦，可以借助 <code>tf.contrib.framework.arg_scope()</code> 来简化代码：     </p>
<pre class=" language-python"><code class="language-python">bg_params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true"># ...}</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>arg_scope<span class="token punctuation">(</span>
        <span class="token punctuation">[</span>fully_connected<span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token comment" spellcheck="true"># 第一个参数，为with块内统一参数的函数列表（这里只为fully_connected函数统一参数）</span>
        normalizer_fn<span class="token operator">=</span>batch_norm<span class="token punctuation">,</span>     <span class="token comment" spellcheck="true"># 对于其他参数，关键字为函数对应的关键字参数名，值为对该参数赋予的值</span>
        normalizer_params<span class="token operator">=</span>bn_params<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 在该with块中的fully_connected函数就无需再重复指明归一化的函数和参数</span>
    hidden1 <span class="token operator">=</span> fully_connected<span class="token punctuation">(</span>X<span class="token punctuation">,</span> n_hidden1<span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token string">"hidden1"</span><span class="token punctuation">)</span>
    hidden2 <span class="token operator">=</span> fully_connected<span class="token punctuation">(</span>hidden1<span class="token punctuation">,</span> n_hidden2<span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token string">"hidden2"</span><span class="token punctuation">)</span>
    logits <span class="token operator">=</span> fully_connected<span class="token punctuation">(</span>hidden2<span class="token punctuation">,</span> n_outputs<span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token string">"outputs"</span><span class="token punctuation">,</span> activation_fn<span class="token operator">=</span>None<span class="token punctuation">)</span>
</code></pre>
<p>这里<code>batch_norm</code> 层默认是不带scale的，如果有需要，可以在参数 <code>bn_params</code> 添加一项 <code>&quot;scale&quot;: True</code> 开启；     </p>
<h3 id="梯度裁剪（Gradient-Clipping）：简单粗暴"><a href="#梯度裁剪（Gradient-Clipping）：简单粗暴" class="headerlink" title="梯度裁剪（Gradient Clipping）：简单粗暴"></a>梯度裁剪（Gradient Clipping）：简单粗暴</h3><p>论文：<a href="http://proceedings.mlr.press/v28/pascanu13.pdf" target="_blank" rel="noopener">On the difficulty of training recurrent neural networks(2012)</a><br>直接限制梯度不能超过一个阈值，在RNN中用的比较多；<br>具体实现：</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token comment" spellcheck="true"># 限制阈值</span>
threshold <span class="token operator">=</span> <span class="token number">1.0</span>
<span class="token comment" spellcheck="true"># 创建优化器</span>
optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>GradientDescentOptimizer<span class="token punctuation">(</span>learning_rate<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 用optimizer.compute_gradients计算梯度</span>
grads_and_vars <span class="token operator">=</span> optimizer<span class="token punctuation">.</span>compute_gradients<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 用tf.clip_by_value裁剪梯度grad，如果小于-threshold则取-threshold，如果大于threshold则取threshold</span>
<span class="token comment" spellcheck="true"># 变量var不变</span>
capped_gvs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>clip_by_value<span class="token punctuation">(</span>grad<span class="token punctuation">,</span> <span class="token operator">-</span>threshold<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span><span class="token punctuation">,</span> var<span class="token punctuation">)</span>
          <span class="token keyword">for</span> grad<span class="token punctuation">,</span> var <span class="token keyword">in</span> grads_and_vars<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># 用optimizer.apply_gradients更新梯度</span>
training_op <span class="token operator">=</span> optimizer<span class="token punctuation">.</span>apply_gradients<span class="token punctuation">(</span>capped_gvs<span class="token punctuation">)</span>
</code></pre>
<p>对于优化器，<code>minimize</code> 方法包含 <code>compute_gradients</code> 和 <code>apply_gradients</code>，计算梯度后直接更新；<br>由于需要裁剪梯度，所以需要单独地使用 <code>compute_gradients</code> 和 <code>apply_gradients</code></p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 来必力 -->
<div id="livere-comment">
    <div id="lv-container" data-id="city" data-uid="MTAyMC8zOTE5OS8xNTcyNg==">
	<script type="text/ls-javascript" id="livere-comment-js">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];
       if (typeof LivereTower === 'function') { return; }
       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;
       e.parentNode.insertBefore(j, e);
   })(document, 'script');
	</script>
</div>
</div>
<style>
    #livere-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/04/08/Handson-ML/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/09/06/机器学习-吴恩达/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/imgs/avatar2.jpg" alt="YaHei's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        hey.yahei.zk@gamil.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: hey.yahei.zk@gamil.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
                <li>
                    <a href="http://music.163.com/#/user/home?id=421946266" target="_blank" title="Netease Cloud Music">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">music_note</i>
                        
                        Netease Cloud Music
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">cloud</i>
                
                标签云
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">event_note</i>
                
                时间轴
            </a>
        </li>
        
    
        <li>
            <a href="/gallery" title="图库">
                
                    <i class="material-icons sidebar-material-icons">photo_library</i>
                
                图库
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">32</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="http://github.com/hey-yahei" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;Hey~YaHei!
            
                <br>
                
                    <a href="http://www.miitbeian.gov.cn" rel="nofollow">浙ICP备17042598号-1</a>
                
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?Bn9UzEm8RrBSxqyZB0zPjA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("sm_js","/js/smoothscroll.js?lOy/ACj5suSNi7ZVFVbpFQ==", true)</script>
    







   





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

    <script src="https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2017;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>

<script type="text/javascript">
    var aTagArr = [].slice.apply(document.getElementsByTagName("a"));
    aTagArr.forEach(function (e, i) {
        if( e.href.lastIndexOf("_blank") > -1 ){
            e.target = "_blank";
            e.href = e.href.replace("?_blank", "");
        }
    });
</script>